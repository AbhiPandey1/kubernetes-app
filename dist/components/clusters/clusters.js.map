{"version":3,"sources":["../../../src/components/clusters/clusters.js"],"names":["_","$","ClustersCtrl","$scope","$injector","backendSrv","contextSrv","$location","self","isOrgEditor","hasRole","document","title","clusters","pageReady","getClusters","then","get","result","filter","cluster","evt","clickTargetIsLinkOrHasLinkParents","target","closest","length","path","search","id","templateUrl"],"mappings":";;;;;;;;;;;;;;;AAAOA,O;;AACAC,O;;;;;;;;;;;;;;;;;;;;;8BAEMC,Y;AACX;AACA,8BAAYC,MAAZ,EAAoBC,SAApB,EAA+BC,UAA/B,EAA2CC,UAA3C,EAAuDC,SAAvD,EAAkE;AAAA;;AAChE,cAAIC,OAAO,IAAX;AACA,eAAKC,WAAL,GAAmBH,WAAWI,OAAX,CAAmB,QAAnB,KAAgCJ,WAAWI,OAAX,CAAmB,OAAnB,CAAnD;AACA,eAAKL,UAAL,GAAkBA,UAAlB;AACA,eAAKE,SAAL,GAAiBA,SAAjB;AACAI,mBAASC,KAAT,GAAiB,wBAAjB;AACA,eAAKC,QAAL,GAAgB,EAAhB;AACA,eAAKC,SAAL,GAAiB,KAAjB;AACA,eAAKC,WAAL,GAAmBC,IAAnB,CAAwB,YAAM;AAC5BR,iBAAKM,SAAL,GAAiB,IAAjB;AACD,WAFD;AAGD;;;;wCAEa;AACZ,gBAAIN,OAAO,IAAX;AACA,mBAAO,KAAKH,UAAL,CAAgBY,GAAhB,CAAoB,kBAApB,EACND,IADM,CACD,UAACE,MAAD,EAAY;AAChBV,mBAAKK,QAAL,GAAgBb,EAAEmB,MAAF,CAASD,MAAT,EAAiB,EAAC,QAAQ,gCAAT,EAAjB,CAAhB;AACD,aAHM,CAAP;AAID;;;sCAEWE,O,EAASC,G,EAAK;AACxB,gBAAIC,oCAAoCrB,EAAEoB,IAAIE,MAAN,EAAcC,OAAd,CAAsB,GAAtB,EAA2BC,MAA3B,GAAoC,CAA5E;AACA,gBAAIH,sCAAsC,KAA1C,EAAiD;AAC/C,mBAAKf,SAAL,CAAemB,IAAf,CAAoB,mDAApB,EAAyEC,MAAzE,CAAgF,EAAC,WAAWP,QAAQQ,EAApB,EAAhF;AACD;AACF;;;;;;;;AAGH1B,mBAAa2B,WAAb,GAA2B,4CAA3B","file":"clusters.js","sourcesContent":["import _ from 'lodash';\nimport $ from 'jquery';\n\nexport class ClustersCtrl {\n  /** @ngInject */\n  constructor($scope, $injector, backendSrv, contextSrv, $location) {\n    var self = this;\n    this.isOrgEditor = contextSrv.hasRole('Editor') || contextSrv.hasRole('Admin');\n    this.backendSrv = backendSrv;\n    this.$location = $location;\n    document.title = 'Grafana Kubernetes App';\n    this.clusters = {};\n    this.pageReady = false;\n    this.getClusters().then(() => {\n      self.pageReady = true;\n    });\n  }\n\n  getClusters() {\n    var self = this;\n    return this.backendSrv.get('/api/datasources')\n    .then((result) => {\n      self.clusters = _.filter(result, {\"type\": \"raintank-kubernetes-datasource\"});\n    });\n  }\n\n  clusterInfo(cluster, evt) {\n    var clickTargetIsLinkOrHasLinkParents = $(evt.target).closest('a').length > 0;\n    if (clickTargetIsLinkOrHasLinkParents === false) {\n      this.$location.path(\"plugins/raintank-kubernetes-app/page/cluster-info\").search({\"cluster\": cluster.id});\n    }\n  }\n}\n\nClustersCtrl.templateUrl = 'components/clusters/partials/clusters.html';\n"]}